# Мотивация

В данный момент мы имеем репутационные проблемы с вязанные с тем что заказы долго обрабатываются или даже теряются внутри нашей системы. 

Чтобы иметь возможность расследовать данные инциденты, определить путь и текущее местонахождение того или иного заказа внутри нашей системы, необходимо внедрить подсистему трейсинга.

## Влияние внедрения трейсинга на метрики

1. Время обработки заказа от создания до конечного статуса
2. Процент успешно обработанных заказов
3. Процент заказов завершившихся ошибкой
4. Процент "потерянных" заказов - созданных, но не дошедших до финального статуса
5. Узкие места в системе - подсистемы где заказы находятся дольше всего
6. Недополученная прибыль - суммарная стоимость заказов из п. 3 и 4

# Предлагаемое решение
Для реализации трейсинга будет использоваться Jaeger и Grafana (см документ ./jewerly_c4_model_ashmakov.drawio).

Сбор данных будет осуществляться со всех подсистем, кроме CRM и MES. Все подсистемы, кроме CRM и MES должны быть доработаны. 

Должен быть внедрен сквозной идентификатор заказа. Он должен передаваться между подсистемами без изменений. По нему мы будем стоить трейс.

# Компромиссы
Телеметрия не будет собираться из CRM и MES ввиду стоимости их доработки.
Это не выглядит большой проблемой, т.к. наша основная задача выяснить причину задержки и исчезновения заказов. Заказы не формируются в этих двух подсистемах, значит мы не пропусти появление новых заказов. И в случае их исчезновения или задержки в CRM или MES мы это поймем по данным трассировки из соседних подсистем.

# Безопасность

1. Авторизация и аутентификация при входе в подсистему трейсинга
2. Маскирование конфиденциальной информации (ФИО, телефоны клиентов, паролей, сумм и тп). Открытое использоватние только технических ID и нечуствительных бизнес данных 
3. Ведение журнала аудита действий пользователя в системе трейсинга
